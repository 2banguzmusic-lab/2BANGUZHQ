<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>2BANGUZHQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

  <style>
    body{
  background:
    linear-gradient(rgba(5,7,10,.88), rgba(5,7,10,.88)),
    url("charlotte-skyline.jpg") center/cover no-repeat fixed;
}

    .buy-btn {
      padding:10px 20px;
      border:1px solid #00B4FF;
      background:transparent;
      color:#00B4FF;
      cursor:pointer;
      margin:5px;
    }
    input, textarea {
      padding:10px;
      margin:5px;
      width:250px;
    }
  </style>
</head>

<body>

  <h1>2BANGUZHQ</h1>

  <!-- AUTH SECTION -->
  <section>
    <h2>Fan Login</h2>

    <input id="authEmail" type="email" placeholder="Email">
    <br>
    <input id="authPassword" type="password" placeholder="Password">
    <br>

    <button onclick="signUp()" class="buy-btn">Sign Up</button>
    <button onclick="logIn()" class="buy-btn">Log In</button>
    <button onclick="logOut()" class="buy-btn">Log Out</button>

    <p id="authStatus"></p>
  </section>

  <hr>

  <!-- MUSIC -->
  <section>
    <h2>Music</h2>

    <audio controls onplay="trackStream('Track One')">
      <source src="song1.mp3" type="audio/mpeg">
    </audio>
  </section>

  <hr>

  <!-- COMMENTS -->
  <section>
    <h2>Comments</h2>

    <textarea id="commentText" placeholder="Leave a comment..."></textarea><br>
    <button onclick="postComment()" class="buy-btn">Post Comment</button>

    <div id="commentsList"></div>
  </section>

  <!-- ðŸ”¥ FIREBASE + APP LOGIC -->
  <script>
    // Firebase config
  const firebaseConfig = {
  apiKey: "AIzaSyDzebcGSAmhOknVGpLry6zCsawHpNGoMNQ",
  authDomain: "banguzhq.firebaseapp.com",
  projectId: "banguzhq",
  storageBucket: "banguzhq.appspot.com",
  messagingSenderId: "455321285766",
  appId: "1:455321285766:web:091deed20ef5873cec0d07",
  measurementId: "G-RF12S35D0T"
};

    firebase.initializeApp(firebaseConfig);

    const db = firebase.firestore();
    const auth = firebase.auth();

    /* AUTH */
    function signUp() {
      const email = authEmail.value;
      const password = authPassword.value;

      auth.createUserWithEmailAndPassword(email, password)
        .then(() => authStatus.innerText = "âœ… Signed up")
        .catch(err => authStatus.innerText = err.message);
    }

    function logIn() {
      const email = authEmail.value;
      const password = authPassword.value;

      auth.signInWithEmailAndPassword(email, password)
        .then(() => authStatus.innerText = "ðŸ”¥ Logged in")
        .catch(err => authStatus.innerText = err.message);
    }

    function logOut() {
      auth.signOut().then(() => {
        authStatus.innerText = "ðŸ‘‹ Logged out";
      });
    }

    auth.onAuthStateChanged(user => {
      if (user) {
        authStatus.innerText = `ðŸŽ§ Logged in as ${user.email}`;
      }
    });

    /* STREAM TRACKING */
    function trackStream(songTitle) {
      db.collection("streams").add({
        song: songTitle,
        time: new Date()
      });
    }

    /* COMMENTS */
    function postComment() {
      const user = auth.currentUser;
      const text = commentText.value;

      if (!user) {
        alert("Please log in to comment.");
        return;
      }

      if (!text.trim()) return;

      db.collection("comments").add({
        text: text,
        user: user.email,
        time: new Date()
      }).then(() => {
        commentText.value = "";
      });
    }

    function loadComments() {
      db.collection("comments")
        .orderBy("time", "desc")
        .onSnapshot(snapshot => {
          commentsList.innerHTML = "";
          snapshot.forEach(doc => {
            const c = doc.data();
            commentsList.innerHTML += `<p><strong>${c.user}</strong>: ${c.text}</p>`;
          });
        });
    }

    loadComments();
  </script>

</body>
</html>
